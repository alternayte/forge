# Code generated by forge generate. DO NOT EDIT.

schema "public" {
  comment = "Generated by Forge"
}

{{range .Resources}}
{{$resourceName := .Name}}
table "{{plural (snake .Name)}}" {
  schema = schema.public

  column "id" {
    type    = uuid
    default = sql("gen_random_uuid()")
    null    = false
  }

  {{range .Fields}}
  column "{{snake .Name}}" {
    type = {{atlasTypeWithModifiers .}}
    null = {{atlasNull .Modifiers}}
    {{if hasDefault .}}default = {{atlasDefault .}}{{end}}
  }
  {{end}}

  {{if .HasTimestamps}}
  column "created_at" {
    type    = timestamptz
    default = sql("now()")
    null    = false
  }
  column "updated_at" {
    type    = timestamptz
    default = sql("now()")
    null    = false
  }
  {{end}}

  {{if .Options.SoftDelete}}
  column "deleted_at" {
    type = timestamptz
    null = true
  }
  {{end}}

  primary_key {
    columns = [column.id]
  }

  {{range .Fields}}
  {{if hasModifier .Modifiers "Unique"}}
  index "{{plural (snake $resourceName)}}_{{snake .Name}}_unique" {
    columns = [column.{{snake .Name}}]
    unique  = true
  }
  {{end}}
  {{if hasModifier .Modifiers "Index"}}
  index "{{plural (snake $resourceName)}}_{{snake .Name}}_idx" {
    columns = [column.{{snake .Name}}]
  }
  {{end}}
  {{end}}
}
{{end}}
